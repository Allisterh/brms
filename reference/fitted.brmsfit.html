<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract Model Fitted Values of <code>brmsfit</code> Objects — fitted.brmsfit • brms</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Extract Model Fitted Values of <code>brmsfit</code> Objects — fitted.brmsfit" />

<meta property="og:description" content="Predict fitted values (i.e., the 'regression line') of a fitted model.
Can be performed for the data used to fit the model 
(posterior predictive checks) or for new data.
By definition, these predictions have smaller variance
than the response predictions performed by
the predict method. 
This is because the measurement error is not incorporated.
The estimated means of both methods should, however, be very similar." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/brms_customfamilies.html">Define Custom Response Distributions with brms</a>
    </li>
    <li>
      <a href="../articles/brms_distreg.html">Estimating Distributional Models with brms</a>
    </li>
    <li>
      <a href="../articles/brms_families.html">Parameterization of Response Distributions in brms</a>
    </li>
    <li>
      <a href="../articles/brms_missings.html">Handle Missing Values with brms</a>
    </li>
    <li>
      <a href="../articles/brms_monotonic.html">Estimating Monotonic Effects with brms</a>
    </li>
    <li>
      <a href="../articles/brms_multivariate.html">Estimating Multivariate Models with brms</a>
    </li>
    <li>
      <a href="../articles/brms_nonlinear.html">Estimating Non-Linear Models with brms</a>
    </li>
    <li>
      <a href="../articles/brms_phylogenetics.html">Estimating Phylogenetic Multilevel Models with brms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paul-buerkner/brms">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract Model Fitted Values of <code>brmsfit</code> Objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/paul-buerkner/brms/blob/master/R/brmsfit-methods.R'><code>R/brmsfit-methods.R</code></a></small>
    <div class="hidden name"><code>fitted.brmsfit.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Predict fitted values (i.e., the 'regression line') of a fitted model.
Can be performed for the data used to fit the model 
(posterior predictive checks) or for new data.
By definition, these predictions have smaller variance
than the response predictions performed by
the <code><a href='predict.brmsfit.html'>predict</a></code> method. 
This is because the measurement error is not incorporated.
The estimated means of both methods should, however, be very similar.</p>
    
    </div>

    <pre class="usage"><span class='co'># S3 method for brmsfit</span>
<span class='fu'>fitted</span>(<span class='no'>object</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>re_formula</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"response"</span>, <span class='st'>"linear"</span>), <span class='kw'>allow_new_levels</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sample_new_levels</span> <span class='kw'>=</span> <span class='st'>"uncertainty"</span>, <span class='kw'>new_objects</span> <span class='kw'>=</span> <span class='fu'>list</span>(),
  <span class='kw'>incl_autocor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>dpar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>resp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>nsamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>sort</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nug</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>summary</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>robust</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.025</span>, <span class='fl'>0.975</span>), <span class='no'>...</span>)

<span class='co'># S3 method for brmsfit</span>
<span class='fu'>posterior_linpred</span>(<span class='no'>object</span>, <span class='kw'>transform</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>re_formula</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>re.form</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>allow_new_levels</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>sample_new_levels</span> <span class='kw'>=</span> <span class='st'>"uncertainty"</span>,
  <span class='kw'>new_objects</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='kw'>incl_autocor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>dpar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>resp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nsamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>sort</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nug</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>robust</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.025</span>, <span class='fl'>0.975</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>brmsfit</code></p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>An optional data.frame for which to evaluate predictions.
If <code>NULL</code> (default), the original data of the model is used.</p></td>
    </tr>
    <tr>
      <th>re_formula</th>
      <td><p>formula containing group-level effects 
to be considered in the prediction. 
If <code>NULL</code> (default), include all group-level effects; 
if <code>NA</code>, include no group-level effects.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>Either <code>"response"</code> or <code>"linear"</code>. 
If <code>"response"</code> results are returned on the scale 
of the response variable. If <code>"linear"</code> 
fitted values are returned on the scale of the linear predictor.</p></td>
    </tr>
    <tr>
      <th>allow_new_levels</th>
      <td><p>A flag indicating if new
levels of group-level effects are allowed 
(defaults to <code>FALSE</code>). 
Only relevant if <code>newdata</code> is provided.</p></td>
    </tr>
    <tr>
      <th>sample_new_levels</th>
      <td><p>Indicates how to sample new levels 
for grouping factors specified in <code>re_formula</code>.
This argument is only relevant if <code>newdata</code> is provided and 
<code>allow_new_levels</code> is set to <code>TRUE</code>.
If <code>"uncertainty"</code> (default), include group-level uncertainty
in the predictions based on the variation of the existing levels. 
If <code>"gaussian"</code>, sample new levels from the (multivariate) 
normal distribution implied by the group-level standard deviations 
and correlations. This options may be useful for conducting 
Bayesian power analysis. 
If <code>"old_levels"</code>, directly sample new levels from the
existing levels.</p></td>
    </tr>
    <tr>
      <th>new_objects</th>
      <td><p>A named <code>list</code> of objects containing 
new data, which cannot be passed via argument <code>newdata</code>.
Currently, only required for objects passed to 
<code><a href='cor_sar.html'>cor_sar</a></code> and 
<code><a href='cor_fixed.html'>cor_fixed</a></code>.</p></td>
    </tr>
    <tr>
      <th>incl_autocor</th>
      <td><p>A flag indicating if ARMA autocorrelation
parameters should be included in the predictions. Defaults to 
<code>TRUE</code>. Setting it to <code>FALSE</code> will not affect other 
correlation structures such as <code><a href='cor_bsts.html'>cor_bsts</a></code>,
or <code><a href='cor_fixed.html'>cor_fixed</a></code>.</p></td>
    </tr>
    <tr>
      <th>dpar</th>
      <td><p>Optional name of a predicted distributional parameter.
If specified, fitted values of this parameters are returned.</p></td>
    </tr>
    <tr>
      <th>resp</th>
      <td><p>Optional names of response variables.
If specified, fitted values of these response variables are returned.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>A numeric vector specifying
the posterior samples to be used. 
If <code>NULL</code> (the default), all samples are used.</p></td>
    </tr>
    <tr>
      <th>nsamples</th>
      <td><p>Positive integer indicating how many 
posterior samples should be used. 
If <code>NULL</code> (the default) all samples are used.
Ignored if <code>subset</code> is not <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>Logical. Only relevant for time series models. 
Indicating whether to return predicted values in the original 
order (<code>FALSE</code>; default) or in the order of the 
time series (<code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>nug</th>
      <td><p>Small positive number for Gaussian process terms only. 
For numerical reasons, the covariance matrix of a Gaussian 
process might not be positive definite. Adding a very small 
number to the matrix's diagonal often solves this problem. 
If <code>NULL</code> (the default), <code>nug</code> is chosen internally.</p></td>
    </tr>
    <tr>
      <th>summary</th>
      <td><p>Should summary statistics 
 (i.e. means, sds, and 95% intervals) be returned
instead of the raw values? Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>If <code>FALSE</code> (the default) the mean is used as 
the measure of central tendency and the standard deviation as 
the measure of variability. If <code>TRUE</code>, the median and the 
median absolute deviation (MAD) are applied instead.
Only used if <code>summary</code> is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>probs</th>
      <td><p>The percentiles to be computed by the <code>quantile</code> 
function. Only used if <code>summary</code> is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    <tr>
      <th>transform</th>
      <td><p>Logical; alias of <code>scale</code>.
If <code>TRUE</code>, <code>scale</code> is set to <code>"response"</code>.
If <code>FALSE</code>, <code>scale</code> is set to <code>"linear"</code>. 
Only implemented for compatibility with the 
<code><a href='http://www.rdocumentation.org/packages/rstantools/topics/posterior_linpred'>posterior_linpred</a></code>
generic.</p></td>
    </tr>
    <tr>
      <th>re.form</th>
      <td><p>Alias of <code>re_formula</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Fitted values extracted from <code>object</code>. 
 The output depends on the family:
 If <code>summary = TRUE</code> it is a N x E x C array 
 for categorical and ordinal models and a N x E matrix else.
 If <code>summary = FALSE</code> it is a S x N x C array 
 for categorical and ordinal models and a S x N matrix else.
 N is the number of observations, S is the number of samples, 
 C is the number of categories, and E is equal to <code>length(probs) + 2</code>.
 In multivariate models, the output is an array of 3 dimensions, 
 where the third dimension indicates the response variables.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>NA</code> values within factors in <code>newdata</code>, 
  are interpreted as if all dummy variables of this factor are 
  zero. This allows, for instance, to make predictions of the grand mean 
  when using sum coding.</p>  
<p>Method <code>posterior_linpred.brmsfit</code> is an alias of 
  <code>fitted.brmsfit</code> with <code>scale = "linear"</code> and
  <code>summary = FALSE</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>## fit a model</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brm.html'>brm</a></span>(<span class='no'>rating</span> ~ <span class='no'>treat</span> + <span class='no'>period</span> + <span class='no'>carry</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>subject</span>),
           <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>inhaler</span>)

<span class='co'>## extract fitted values</span>
<span class='no'>fitted_values</span> <span class='kw'>&lt;-</span> <span class='fu'>fitted</span>(<span class='no'>fit</span>)
<span class='fu'>head</span>(<span class='no'>fitted_values</span>)

<span class='co'>## plot fitted means against actual response</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>as.data.frame</span>(<span class='fu'>cbind</span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='fu'><a href='standata.html'>standata</a></span>(<span class='no'>fit</span>)$<span class='no'>Y</span>, <span class='no'>fitted_values</span>))
<span class='fu'>ggplot</span>(<span class='no'>dat</span>) + <span class='fu'>geom_point</span>(<span class='fu'>aes</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>Estimate</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Y</span>))
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

