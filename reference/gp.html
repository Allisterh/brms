<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Set up Gaussian process terms in <span class="pkg">brms</span> — gp • brms</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Set up Gaussian process terms in <span class="pkg">brms</span> — gp" />

<meta property="og:description" content="Function used to set up a Gaussian process term in brms.
The function does not evaluate its arguments --
it exists purely to help set up a model with Gaussian process terms." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/brms">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set up Gaussian process terms in <span class="pkg">brms</span></h1>
    <small class="dont-index">Source: <a href='https://github.com/paul-buerkner/brms/blob/master/R/formula-helpers.R'><code>R/formula-helpers.R</code></a></small>
    <div class="hidden name"><code>gp.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Function used to set up a Gaussian process term in <span class="pkg">brms</span>.
The function does not evaluate its arguments --
it exists purely to help set up a model with Gaussian process terms.</p>
    
    </div>

    <pre class="usage"><span class='fu'>gp</span>(<span class='no'>...</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>cov</span> <span class='kw'>=</span> <span class='st'>"exp_quad"</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>One or more predictors for the Gaussian process.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>A numeric or factor variable of the same length as 
each predictor. In the numeric vector case, the elements multiply 
the values returned by the Gaussian process. In the factor variable 
case, a separate Gaussian process is fitted for each factor level.</p></td>
    </tr>
    <tr>
      <th>cov</th>
      <td><p>Name of the covariance kernel. By default, 
the exponentiated-quadratic kernel <code>"exp_quad"</code> is used.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>Logical; If <code>TRUE</code> (the default), predictors are
scaled so that the maximum Euclidean distance between two points
is 1. Since the default prior on <code>lscale</code> expects scaled
predictors, it is recommended to manually specify priors
on <code>lscale</code>, if <code>scale</code> is set to <code>FALSE</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>'gpterm'</code>, which is a list 
  of arguments to be interpreted by the formula 
  parsing functions of <code>brms</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A Gaussian process is a stochastic process, which
 describes the relation between one or more predictors 
 \(x = (x_1, ..., x_d)\) and a response \(f(x)\), where 
 \(d\) is the number of predictors. A Gaussian process is the
 generalization of the multivariate normal distribution
 to an infinite number of dimensions. Thus, it can be
 interpreted as a prior over functions. Any finite sample 
 realized from this stochastic process is jointly multivariate 
 normal, with a covariance matrix defined by the covariance
 kernel \(k_p(x)\), where \(p\) is the vector of parameters
 of the Gaussian process:
 $$f(x) ~ MVN(0, k_p(x))$$
 The smoothness and general behavior of the function \(f\) 
 depends only on the choice of covariance kernel. 
 For a more detailed introduction to Gaussian processes,
 see <a href='https://en.wikipedia.org/wiki/Gaussian_process'>https://en.wikipedia.org/wiki/Gaussian_process</a>.</p> 
<p>Below, we describe the currently supported covariance kernels:</p><ul>
<li><p>"exp_quad": The exponentiated-quadratic kernel is defined as
   \(k(x_i, x_j) = sdgp^2 exp(- || x_i - x_j || / (2 lscale^2)\),
   where \(|| . ||\) is the Euclidean norm, \(sdgp\) is a 
   standard deviation parameter, and \(lscale\) is characteristic 
   length-scale parameter. The latter practically measures how close two 
   points \(x_i\) and \(x_j\) have to be to influence each other 
   substantially.</p></li>
</ul>
    <p>In the current implementation, <code>"exp_quad"</code> is the only supported 
 covariance kernel. More options will follow in the future.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='brmsformula.html'>brmsformula</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># simulate data using the mgcv package</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mgcv</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/mgcv/topics/gamSim'>gamSim</a></span>(<span class='fl'>1</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'># fit a simple gaussian process model</span>
<span class='no'>fit1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brm.html'>brm</a></span>(<span class='no'>y</span> ~ <span class='fu'>gp</span>(<span class='no'>x2</span>), <span class='no'>dat</span>, <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>summary</span>(<span class='no'>fit1</span>)
<span class='no'>me1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='marginal_effects.html'>marginal_effects</a></span>(<span class='no'>fit1</span>, <span class='kw'>nsamples</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>spaghetti</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>plot</span>(<span class='no'>me1</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>points</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># fit a more complicated gaussian process model</span>
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brm.html'>brm</a></span>(<span class='no'>y</span> ~ <span class='fu'>gp</span>(<span class='no'>x0</span>) + <span class='no'>x1</span> + <span class='fu'>gp</span>(<span class='no'>x2</span>) + <span class='no'>x3</span>, <span class='no'>dat</span>, <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>summary</span>(<span class='no'>fit2</span>)
<span class='no'>me2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='marginal_effects.html'>marginal_effects</a></span>(<span class='no'>fit2</span>, <span class='kw'>nsamples</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>spaghetti</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>plot</span>(<span class='no'>me2</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>points</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># fit a multivariate gaussian process model</span>
<span class='no'>fit3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brm.html'>brm</a></span>(<span class='no'>y</span> ~ <span class='fu'>gp</span>(<span class='no'>x1</span>, <span class='no'>x2</span>), <span class='no'>dat</span>, <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>summary</span>(<span class='no'>fit3</span>)
<span class='no'>me3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='marginal_effects.html'>marginal_effects</a></span>(<span class='no'>fit3</span>, <span class='kw'>nsamples</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>spaghetti</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>plot</span>(<span class='no'>me3</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>points</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># compare model fit</span>
<span class='fu'><a href='loo.brmsfit.html'>LOO</a></span>(<span class='no'>fit1</span>, <span class='no'>fit2</span>, <span class='no'>fit3</span>)

<span class='co'># simulate data with a factor covariate</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mgcv</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/mgcv/topics/gamSim'>gamSim</a></span>(<span class='fl'>4</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>90</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'># fit separate gaussian processes for different levels of 'fac'</span>
<span class='no'>fit4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brm.html'>brm</a></span>(<span class='no'>y</span> ~ <span class='fu'>gp</span>(<span class='no'>x2</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='no'>fac</span>), <span class='no'>dat2</span>, <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>summary</span>(<span class='no'>fit4</span>)
<span class='fu'>plot</span>(<span class='fu'><a href='marginal_effects.html'>marginal_effects</a></span>(<span class='no'>fit4</span>), <span class='kw'>points</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

