<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Samples from the Posterior Predictive Distribution — posterior_predict.brmsfit • brms</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Samples from the Posterior Predictive Distribution — posterior_predict.brmsfit" />
<meta property="og:description" content="Compute posterior samples of the posterior predictive distribution. Can be
performed for the data used to fit the model (posterior predictive checks) or
for new data. By definition, these samples have higher variance than samples
of the means of the posterior predictive distribution computed by
posterior_epred.brmsfit. This is because the residual error
is incorporated in posterior_predict. However, the estimated means of
both methods averaged across samples should be very similar." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.13.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/brms">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Samples from the Posterior Predictive Distribution</h1>
    <small class="dont-index">Source: <a href='https://github.com/paul-buerkner/brms/blob/master/R/posterior_predict.R'><code>R/posterior_predict.R</code></a></small>
    <div class="hidden name"><code>posterior_predict.brmsfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute posterior samples of the posterior predictive distribution. Can be
performed for the data used to fit the model (posterior predictive checks) or
for new data. By definition, these samples have higher variance than samples
of the means of the posterior predictive distribution computed by
<code><a href='posterior_epred.brmsfit.html'>posterior_epred.brmsfit</a></code>. This is because the residual error
is incorporated in <code>posterior_predict</code>. However, the estimated means of
both methods averaged across samples should be very similar.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for brmsfit</span>
<span class='fu'>posterior_predict</span>(
  <span class='no'>object</span>,
  <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>re_formula</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>re.form</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>transform</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>resp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>negative_rt</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>nsamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sort</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>ntrys</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>brmsfit</code>.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>An optional data.frame for which to evaluate predictions. If
<code>NULL</code> (default), the original data of the model is used.
<code>NA</code> values within factors are interpreted as if all dummy
variables of this factor are zero. This allows, for instance, to make
predictions of the grand mean when using sum coding.</p></td>
    </tr>
    <tr>
      <th>re_formula</th>
      <td><p>formula containing group-level effects to be considered in
the prediction. If <code>NULL</code> (default), include all group-level effects;
if <code>NA</code>, include no group-level effects.</p></td>
    </tr>
    <tr>
      <th>re.form</th>
      <td><p>Alias of <code>re_formula</code>.</p></td>
    </tr>
    <tr>
      <th>transform</th>
      <td><p>(Deprecated) A function or a character string naming 
a function to be applied on the predicted responses
before summary statistics are computed.</p></td>
    </tr>
    <tr>
      <th>resp</th>
      <td><p>Optional names of response variables. If specified, predictions
are performed only for the specified response variables.</p></td>
    </tr>
    <tr>
      <th>negative_rt</th>
      <td><p>Only relevant for Wiener diffusion models. 
A flag indicating whether response times of responses
on the lower boundary should be returned as negative values.
This allows to distinguish responses on the upper and
lower boundary. Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>nsamples</th>
      <td><p>Positive integer indicating how many posterior samples should
be used. If <code>NULL</code> (the default) all samples are used. Ignored if
<code>subset</code> is not <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>A numeric vector specifying the posterior samples to be used.
If <code>NULL</code> (the default), all samples are used.</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>Logical. Only relevant for time series models. 
Indicating whether to return predicted values in the original 
order (<code>FALSE</code>; default) or in the order of the 
time series (<code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>ntrys</th>
      <td><p>Parameter used in rejection sampling 
for truncated discrete models only 
(defaults to <code>5</code>). See Details for more information.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to <code><a href='prepare_predictions.html'>prepare_predictions</a></code>
that control several aspects of data validation and prediction.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code>array</code> of predicted response values. If <code>summary =
  FALSE</code>, the output is as an S x N matrix, where S is the number of
  posterior samples and N is the number of observations. In multivariate
  models, an additional dimension is added to the output which indexes along
  the different response variables.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>NA</code> values within factors in <code>newdata</code>, 
  are interpreted as if all dummy variables of this factor are 
  zero. This allows, for instance, to make predictions of the grand mean 
  when using sum coding.</p>
<p>For truncated discrete models only: In the absence of any general algorithm
  to sample from truncated discrete distributions, rejection sampling is
  applied in this special case. This means that values are sampled until a
  value lies within the defined truncation boundaries. In practice, this
  procedure may be rather slow (especially in <span style="R">R</span>). Thus, we try to do
  approximate rejection sampling by sampling each value <code>ntrys</code> times
  and then select a valid value. If all values are invalid, the closest
  boundary is used, instead. If there are more than a few of these
  pathological cases, a warning will occur suggesting to increase argument
  <code>ntrys</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## fit a model</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brm.html'>brm</a></span>(<span class='no'>time</span> <span class='kw'>|</span> <span class='fu'>cens</span>(<span class='no'>censored</span>) ~ <span class='no'>age</span> + <span class='no'>sex</span> + (<span class='fl'>1</span> + <span class='no'>age</span> <span class='kw'>||</span> <span class='no'>patient</span>),
           <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>kidney</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"exponential"</span>, <span class='kw'>inits</span> <span class='kw'>=</span> <span class='st'>"0"</span>)

<span class='co'>## predicted responses</span>
<span class='no'>pp</span> <span class='kw'>&lt;-</span> <span class='fu'>posterior_predict</span>(<span class='no'>fit</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>pp</span>)

<span class='co'>## predicted responses excluding the group-level effect of age</span>
<span class='no'>pp</span> <span class='kw'>&lt;-</span> <span class='fu'>posterior_predict</span>(<span class='no'>fit</span>, <span class='kw'>re_formula</span> <span class='kw'>=</span> ~ (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>patient</span>))
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>pp</span>)

<span class='co'>## predicted responses of patient 1 for new data</span>
<span class='no'>newdata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
  <span class='kw'>sex</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"male"</span>, <span class='st'>"female"</span>)),
  <span class='kw'>age</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>, <span class='fl'>50</span>),
  <span class='kw'>patient</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>)
)
<span class='no'>pp</span> <span class='kw'>&lt;-</span> <span class='fu'>posterior_predict</span>(<span class='no'>fit</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='no'>newdata</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>pp</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


