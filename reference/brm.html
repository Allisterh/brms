<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit Bayesian Generalized (Non-)Linear Multivariate Multilevel Models — brm • brms</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit Bayesian Generalized (Non-)Linear Multivariate Multilevel Models — brm" />

<meta property="og:description" content="Fit Bayesian generalized (non-)linear multivariate multilevel models 
using Stan for full Bayesian inference. A wide range of distributions 
and link functions are supported, allowing users to fit -- among others -- 
linear, robust linear, count data, survival, response times, ordinal, 
zero-inflated, hurdle, and even self-defined mixture models all in a 
multilevel context. Further modeling options include non-linear and 
smooth terms, auto-correlation structures, censored data, meta-analytic 
standard errors, and quite a few more. In addition, all parameters of the 
response distributions can be predicted in order to perform distributional 
regression. Prior specifications are flexible and explicitly encourage 
users to apply prior distributions that actually reflect their beliefs.
In addition, model fit can easily be assessed and compared with
posterior predictive checks and leave-one-out cross-validation." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.10.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/brms">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Bayesian Generalized (Non-)Linear Multivariate Multilevel Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/paul-buerkner/brms/blob/master/R/brm.R'><code>R/brm.R</code></a></small>
    <div class="hidden name"><code>brm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fit Bayesian generalized (non-)linear multivariate multilevel models 
using Stan for full Bayesian inference. A wide range of distributions 
and link functions are supported, allowing users to fit -- among others -- 
linear, robust linear, count data, survival, response times, ordinal, 
zero-inflated, hurdle, and even self-defined mixture models all in a 
multilevel context. Further modeling options include non-linear and 
smooth terms, auto-correlation structures, censored data, meta-analytic 
standard errors, and quite a few more. In addition, all parameters of the 
response distributions can be predicted in order to perform distributional 
regression. Prior specifications are flexible and explicitly encourage 
users to apply prior distributions that actually reflect their beliefs.
In addition, model fit can easily be assessed and compared with
posterior predictive checks and leave-one-out cross-validation.</p>
    
    </div>

    <pre class="usage"><span class='fu'>brm</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/family'>gaussian</a></span>(), <span class='kw'>prior</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>autocor</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cov_ranef</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>sample_prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"no"</span>, <span class='st'>"yes"</span>, <span class='st'>"only"</span>),
  <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>knots</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>stanvars</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>stan_funs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fit</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>save_ranef</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>save_mevars</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>save_all_pars</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>inits</span> <span class='kw'>=</span> <span class='st'>"random"</span>, <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>2000</span>,
  <span class='kw'>warmup</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>floor</a></span>(<span class='no'>iter</span>/<span class='fl'>2</span>), <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"mc.cores"</span>,
  <span class='fl'>1L</span>), <span class='kw'>control</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"sampling"</span>, <span class='st'>"meanfield"</span>,
  <span class='st'>"fullrank"</span>), <span class='kw'>future</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"future"</span>, <span class='fl'>FALSE</span>), <span class='kw'>silent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>save_model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>stan_model_args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(),
  <span class='kw'>save_dso</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>An object of class <code><a href='https://www.rdocumentation.org/packages/stats/topics/formula'>formula</a></code>,
<code><a href='brmsformula.html'>brmsformula</a></code>, or <code><a href='mvbrmsformula.html'>mvbrmsformula</a></code> (or one that can
be coerced to that classes): A symbolic description of the model to be
fitted. The details of model specification are explained in
<code><a href='brmsformula.html'>brmsformula</a></code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>An object of class <code>data.frame</code> (or one that can be coerced
to that class) containing data of all variables used in the model.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>A description of the response distribution and link function to
be used in the model. This can be a family function, a call to a family
function or a character string naming the family. Every family function has
a <code>link</code> argument allowing to specify the link function to be applied
on the response variable. If not specified, default links are used. For
details of supported families see <code><a href='brmsfamily.html'>brmsfamily</a></code>. By default, a
linear <code>gaussian</code> model is applied. In multivariate models,
<code>family</code> might also be a list of families.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>One or more <code>brmsprior</code> objects created by
<code><a href='set_prior.html'>set_prior</a></code> or related functions and combined using the
<code>c</code> method or the <code>+</code> operator. See also  <code><a href='get_prior.html'>get_prior</a></code>
for more help.</p></td>
    </tr>
    <tr>
      <th>autocor</th>
      <td><p>An optional <code><a href='cor_brms.html'>cor_brms</a></code> object describing the
correlation structure within the response variable (i.e., the
'autocorrelation'). See the documentation of <code><a href='cor_brms.html'>cor_brms</a></code> for a
description of the available correlation structures. Defaults to
<code>NULL</code>, corresponding to no correlations. In multivariate models,
<code>autocor</code> might also be a list of autocorrelation structures.</p></td>
    </tr>
    <tr>
      <th>cov_ranef</th>
      <td><p>A list of matrices that are proportional to the (within)
covariance structure of the group-level effects. The names of the matrices
should correspond to columns in <code>data</code> that are used as grouping
factors. All levels of the grouping factor should appear as rownames of the
corresponding matrix. This argument can be used, among others to model
pedigrees and phylogenetic effects. See
<code><a href='../articles/brms_phylogenetics.html'>vignette("brms_phylogenetics")</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>sample_prior</th>
      <td><p>Indicate if samples from priors should be drawn 
additionally to the posterior samples (defaults to <code>"no"</code>). Among 
others, these samples can be used to calculate Bayes factors for point 
hypotheses via <code><a href='hypothesis.html'>hypothesis</a></code>. Please note that improper priors 
are not sampled, including the default improper priors used by <code>brm</code>. 
See <code><a href='set_prior.html'>set_prior</a></code> on how to set (proper) priors. Please also note
that prior samples for the overall intercept are not obtained by default for 
technical reasons. See <code><a href='brmsformula.html'>brmsformula</a></code> how to obtain prior samples 
for the intercept. If <code>sample_prior</code> is set to <code>"only"</code>, samples 
are drawn solely from the priors ignoring the likelihood, which allows among 
others to generate samples from the prior predictive distribution. In this 
case, all parameters must have proper priors.</p></td>
    </tr>
    <tr>
      <th>sparse</th>
      <td><p>(Deprecated) Logical; indicates whether the population-level
design matrices should be treated as sparse (defaults to <code>FALSE</code>). For
design matrices with many zeros, this can considerably reduce required
memory. Sampling speed is currently not improved or even slightly
decreased. It is now recommended to use the <code>sparse</code> argument of
<code><a href='brmsformula.html'>brmsformula</a></code> and related functions.</p></td>
    </tr>
    <tr>
      <th>knots</th>
      <td><p>Optional list containing user specified knot values to be used
for basis construction of smoothing terms. See
<code><a href='https://www.rdocumentation.org/packages/mgcv/topics/gamm'>gamm</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>stanvars</th>
      <td><p>An optional <code>stanvars</code> object generated by function
<code><a href='stanvar.html'>stanvar</a></code> to define additional variables for use in
<span class="pkg">Stan</span>'s program blocks.</p></td>
    </tr>
    <tr>
      <th>stan_funs</th>
      <td><p>(Deprecated) An optional character string containing
self-defined  <span class="pkg">Stan</span> functions, which will be included in the functions
block of the generated <span class="pkg">Stan</span> code. It is now recommended to use the
<code>stanvars</code> argument for this purpose, instead.</p></td>
    </tr>
    <tr>
      <th>fit</th>
      <td><p>An instance of S3 class <code>brmsfit</code> derived from a previous
fit; defaults to <code>NA</code>. If <code>fit</code> is of class <code>brmsfit</code>, the
compiled model associated with the fitted result is re-used and all
arguments modifying the model code or data are ignored. It is not
recommended to use this argument directly, but to call the
<code><a href='update.brmsfit.html'>update</a></code> method, instead.</p></td>
    </tr>
    <tr>
      <th>save_ranef</th>
      <td><p>A flag to indicate if group-level effects for each level of
the grouping factor(s) should be saved (default is <code>TRUE</code>). Set to
<code>FALSE</code> to save memory. The argument has no impact on the model
fitting itself.</p></td>
    </tr>
    <tr>
      <th>save_mevars</th>
      <td><p>A flag to indicate if samples of latent noise-free
variables obtained by using <code>me</code> and <code>mi</code> terms should be saved
(default is <code>FALSE</code>). Saving these samples allows to better use
methods such as <code>predict</code> with the latent variables but leads to very
large <span style="R">R</span> objects even for models of moderate size and complexity.</p></td>
    </tr>
    <tr>
      <th>save_all_pars</th>
      <td><p>A flag to indicate if samples from all variables defined
in Stan's <code>parameters</code> block should be saved (default is
<code>FALSE</code>). Saving these samples is required in order to apply the
methods <code>bridge_sampler</code>, <code>bayes_factor</code>, and <code>post_prob</code>.</p></td>
    </tr>
    <tr>
      <th>inits</th>
      <td><p>Either <code>"random"</code> or <code>"0"</code>. If inits is
<code>"random"</code> (the default), Stan will randomly generate initial values
for parameters. If it is <code>"0"</code>, all parameters are initialized to
zero. This option is sometimes useful for certain families, as it happens
that default (<code>"random"</code>) inits cause samples to be essentially
constant. Generally, setting <code>inits = "0"</code> is worth a try, if chains
do not behave well. Alternatively, <code>inits</code> can be a list of lists
containing the initial values, or a function (or function name) generating
initial values. The latter options are mainly implemented for internal
testing.</p></td>
    </tr>
    <tr>
      <th>chains</th>
      <td><p>Number of Markov chains (defaults to 4).</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Number of total iterations per chain (including warmup; defaults
to 2000).</p></td>
    </tr>
    <tr>
      <th>warmup</th>
      <td><p>A positive integer specifying number of warmup (aka burnin)
iterations. This also specifies the number of iterations used for stepsize
adaptation, so warmup samples should not be used for inference. The number
of warmup should not be larger than <code>iter</code> and the default is
<code>iter/2</code>.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>Thinning rate. Must be a positive integer. Set <code>thin &gt; 1</code> to
save memory and computation time if <code>iter</code> is large.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Number of cores to use when executing the chains in parallel,
which defaults to 1 but we recommend setting the <code>mc.cores</code> option to
be as many processors as the hardware and RAM allow (up to the number of
chains). For non-Windows OS in non-interactive <span style="R">R</span> sessions, forking is used
instead of PSOCK clusters.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A named <code>list</code> of parameters to control the sampler's
behavior. It defaults to <code>NULL</code> so all the default values are used.
The most important control parameters are discussed in the 'Details'
section below. For a comprehensive overview see
<code><a href='https://www.rdocumentation.org/packages/rstan/topics/stan'>stan</a></code>.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>Character string indicating the estimation approach to use.
Can be <code>"sampling"</code> for MCMC (the default), <code>"meanfield"</code> for
variational inference with independent normal distributions, or
<code>"fullrank"</code> for variational inference with a multivariate normal
distribution.</p></td>
    </tr>
    <tr>
      <th>future</th>
      <td><p>Logical; If <code>TRUE</code>, the <span class="pkg"><a href='https://www.rdocumentation.org/packages/future/topics/future'>future</a></span>
package is used for parallel execution of the chains and argument
<code>cores</code> will be ignored. Can be set globally for the current <span style="R">R</span>
session via the <code>future</code> option. The execution type is controlled via
<code><a href='https://www.rdocumentation.org/packages/future/topics/plan'>plan</a></code> (see the examples section below).</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>logical; If <code>TRUE</code> (the default), most of the
informational messages of compiler and sampler are suppressed. The actual
sampling progress is still printed. Set <code>refresh = 0</code> to turn this off
as well. To stop Stan from opening additional progress bars, set
<code>open_progress = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>The seed for random number generation to make results
reproducible. If <code>NA</code> (the default), <span class="pkg">Stan</span> will set the seed
randomly.</p></td>
    </tr>
    <tr>
      <th>save_model</th>
      <td><p>Either <code>NULL</code> or a character string. In the latter
case, the model's Stan code is saved via <code><a href='https://www.rdocumentation.org/packages/base/topics/cat'>cat</a></code> in a text file
named after the string supplied in <code>save_model</code>.</p></td>
    </tr>
    <tr>
      <th>stan_model_args</th>
      <td><p>A <code>list</code> of further arguments passed to
<code><a href='https://www.rdocumentation.org/packages/rstan/topics/stan_model'>stan_model</a></code>.</p></td>
    </tr>
    <tr>
      <th>save_dso</th>
      <td><p>Logical, defaulting to <code>TRUE</code>, indicating whether the
dynamic shared object (DSO) compiled from the C++ code for the model will
be saved or not. If <code>TRUE</code>, we can draw samples from the same model in
another <span style="R">R</span> session using the saved DSO (i.e., without compiling the C++
code again).</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>Either <code>NULL</code> or a character string. In the latter case, the
fitted model object is saved via <code><a href='https://www.rdocumentation.org/packages/base/topics/readRDS'>saveRDS</a></code> in a file named
after the string supplied in <code>file</code>. The <code>.rds</code> extension is
added automatically. If the file already exists, <code>brm</code> will load and
return the saved model object instead of refitting the model. As existing
files won't be overwritten, you have to manually remove the file in order
to refit and save the model under an existing file name. The file name
is stored in the <code>brmsfit</code> object for later usage.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to Stan that is to
<code><a href='https://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-sampling'>sampling</a></code> or <code><a href='https://www.rdocumentation.org/packages/rstan/topics/stanmodel-method-vb'>vb</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>brmsfit</code>, which contains the posterior
  samples along with many other useful information about the model. Use
  <code><a href='https://www.rdocumentation.org/packages/utils/topics/methods'>methods(class = "brmsfit")</a></code> for an overview on available methods.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Fit a generalized (non-)linear multivariate multilevel model via
  full Bayesian inference using Stan. A general overview is provided in the
  vignettes <code>vignette("brms_overview")</code> and
  <code>vignette("brms_multilevel")</code>. For a full list of available vignettes
  see <code>vignette(package = "brms")</code>.</p>
<p><b>Formula syntax of brms models</b></p>
<p>Details of the formula syntax applied in <span class="pkg">brms</span> can be found in
  <code><a href='brmsformula.html'>brmsformula</a></code>.</p>
<p><b>Families and link functions</b></p>
<p>Details of families supported by <span class="pkg">brms</span> can be found in
  <code><a href='brmsfamily.html'>brmsfamily</a></code>.</p>
<p><b>Prior distributions</b></p>
<p>Priors should be specified using the
  <code><a href='set_prior.html'>set_prior</a></code> function. Its documentation
  contains detailed information on how to correctly specify priors. To find
  out on which parameters or parameter classes priors can be defined, use
  <code><a href='get_prior.html'>get_prior</a></code>. Default priors are chosen to be
  non or very weakly informative so that their influence on the results will
  be negligible and you usually don't have to worry about them. However,
  after getting more familiar with Bayesian statistics, I recommend you to
  start thinking about reasonable informative priors for your model
  parameters: Nearly always, there is at least some prior information
  available that can be used to improve your inference.</p>
<p><b>Adjusting the sampling behavior of <span class="pkg">Stan</span></b></p>
<p>In addition to choosing the number of iterations, warmup samples, and
  chains, users can control the behavior of the NUTS sampler, by using the
  <code>control</code> argument. The most important reason to use <code>control</code> is
  to decrease (or eliminate at best) the number of divergent transitions that
  cause a bias in the obtained posterior samples. Whenever you see the
  warning "There were x divergent transitions after warmup." you should
  really think about increasing <code>adapt_delta</code>. To do this, write
  <code>control = list(adapt_delta = &lt;x&gt;)</code>, where <code>&lt;x&gt;</code> should usually
  be value between <code>0.8</code> (current default) and <code>1</code>. Increasing
  <code>adapt_delta</code> will slow down the sampler but will decrease the number
  of divergent transitions threatening the validity of your posterior
  samples.</p>
<p>Another problem arises when the depth of the tree being evaluated in each
  iteration is exceeded. This is less common than having divergent
  transitions, but may also bias the posterior samples. When it happens,
  <span class="pkg">Stan</span> will throw out a warning suggesting to increase
  <code>max_treedepth</code>, which can be accomplished by writing <code>control =
  list(max_treedepth = &lt;x&gt;)</code> with a positive integer <code>&lt;x&gt;</code> that should
  usually be larger than the current default of <code>10</code>. For more details
  on the <code>control</code> argument see <code><a href='https://www.rdocumentation.org/packages/rstan/topics/stan'>stan</a></code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Paul-Christian Buerkner (2017). brms: An R Package for Bayesian Multilevel 
Models Using Stan. <em>Journal of Statistical Software</em>, 80(1), 1-28. 
<code>doi:10.18637/jss.v080.i01</code></p>
<p>Paul-Christian Buerkner (2018). Advanced Bayesian Multilevel Modeling 
with the R Package brms. <em>The R Journal</em>. 10(1), 395–411. 
<code>doi:10.32614/RJ-2018-017</code></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='brms-package.html'>brms</a></code>, <code><a href='brmsformula.html'>brmsformula</a></code>,
<code><a href='brmsfamily.html'>brmsfamily</a></code>, <code><a href='brmsfit-class.html'>brmsfit</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># Poisson regression for the number of seizures in epileptic patients</span>
<span class='co'># using student_t priors for population-level effects</span>
<span class='co'># and half cauchy priors for standard deviations of group-level effects</span>
<span class='no'>bprior1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='set_prior.html'>prior</a></span>(<span class='fu'>student_t</span>(<span class='fl'>5</span>,<span class='fl'>0</span>,<span class='fl'>10</span>), <span class='kw'>class</span> <span class='kw'>=</span> <span class='no'>b</span>) +
  <span class='fu'><a href='set_prior.html'>prior</a></span>(<span class='fu'>cauchy</span>(<span class='fl'>0</span>,<span class='fl'>2</span>), <span class='kw'>class</span> <span class='kw'>=</span> <span class='no'>sd</span>)
<span class='no'>fit1</span> <span class='kw'>&lt;-</span> <span class='fu'>brm</span>(<span class='no'>count</span> ~ <span class='no'>zAge</span> + <span class='no'>zBase</span> * <span class='no'>Trt</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>patient</span>),
            <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>epilepsy</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/family'>poisson</a></span>(), <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>bprior1</span>)

<span class='co'># generate a summary of the results</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit1</span>)

<span class='co'># plot the MCMC chains as well as the posterior distributions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>fit1</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># predict responses based on the fitted model</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/predict'>predict</a></span>(<span class='no'>fit1</span>))

<span class='co'># plot conditional effects for each predictor</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'><a href='conditional_effects.html'>conditional_effects</a></span>(<span class='no'>fit1</span>), <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># investigate model fit</span>
<span class='fu'><a href='loo.brmsfit.html'>loo</a></span>(<span class='no'>fit1</span>)
<span class='fu'><a href='pp_check.brmsfit.html'>pp_check</a></span>(<span class='no'>fit1</span>)


<span class='co'># Ordinal regression modeling patient's rating of inhaler instructions</span>
<span class='co'># category specific effects are estimated for variable 'treat'</span>
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'>brm</span>(<span class='no'>rating</span> ~ <span class='no'>period</span> + <span class='no'>carry</span> + <span class='fu'><a href='cs.html'>cs</a></span>(<span class='no'>treat</span>),
            <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>inhaler</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='brmsfamily.html'>sratio</a></span>(<span class='st'>"logit"</span>),
            <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='set_prior.html'>set_prior</a></span>(<span class='st'>"normal(0,5)"</span>), <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit2</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>fit2</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='waic.brmsfit.html'>WAIC</a></span>(<span class='no'>fit2</span>)


<span class='co'># Survival regression modeling the time between the first</span>
<span class='co'># and second recurrence of an infection in kidney patients.</span>
<span class='no'>fit3</span> <span class='kw'>&lt;-</span> <span class='fu'>brm</span>(<span class='no'>time</span> <span class='kw'>|</span> <span class='fu'>cens</span>(<span class='no'>censored</span>) ~ <span class='no'>age</span> * <span class='no'>sex</span> + <span class='no'>disease</span> + (<span class='fl'>1</span><span class='kw'>|</span><span class='no'>patient</span>),
            <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>kidney</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='brmsfamily.html'>lognormal</a></span>())
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit3</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>fit3</span>, <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'><a href='conditional_effects.html'>conditional_effects</a></span>(<span class='no'>fit3</span>), <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)


<span class='co'># Probit regression using the binomial family</span>
<span class='no'>ntrials</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='fl'>100</span>, <span class='fl'>TRUE</span>)
<span class='no'>success</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Binomial'>rbinom</a></span>(<span class='fl'>100</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='no'>ntrials</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.4</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>)
<span class='no'>data4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='no'>ntrials</span>, <span class='no'>success</span>, <span class='no'>x</span>)
<span class='no'>fit4</span> <span class='kw'>&lt;-</span> <span class='fu'>brm</span>(<span class='no'>success</span> <span class='kw'>|</span> <span class='fu'>trials</span>(<span class='no'>ntrials</span>) ~ <span class='no'>x</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>data4</span>,
            <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/family'>binomial</a></span>(<span class='st'>"probit"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit4</span>)


<span class='co'># Simple non-linear gaussian model</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>100</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>2</span> - <span class='fl'>1.5</span>^<span class='no'>x</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>data5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='no'>x</span>, <span class='no'>y</span>)
<span class='no'>bprior5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='set_prior.html'>prior</a></span>(<span class='fu'>normal</span>(<span class='fl'>0</span>, <span class='fl'>2</span>), <span class='kw'>nlpar</span> <span class='kw'>=</span> <span class='no'>a1</span>) +
  <span class='fu'><a href='set_prior.html'>prior</a></span>(<span class='fu'>normal</span>(<span class='fl'>0</span>, <span class='fl'>2</span>), <span class='kw'>nlpar</span> <span class='kw'>=</span> <span class='no'>a2</span>)
<span class='no'>fit5</span> <span class='kw'>&lt;-</span> <span class='fu'>brm</span>(<span class='fu'><a href='brmsformula.html'>bf</a></span>(<span class='no'>y</span> ~ <span class='no'>a1</span> - <span class='no'>a2</span>^<span class='no'>x</span>, <span class='no'>a1</span> + <span class='no'>a2</span> ~ <span class='fl'>1</span>, <span class='kw'>nl</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>),
            <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>data5</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>bprior5</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit5</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'><a href='conditional_effects.html'>conditional_effects</a></span>(<span class='no'>fit5</span>), <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)


<span class='co'># Normal model with heterogeneous variances</span>
<span class='no'>data_het</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>50</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>50</span>, <span class='fl'>1</span>, <span class='fl'>2</span>)),
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"a"</span>, <span class='st'>"b"</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>50</span>))
)
<span class='no'>fit6</span> <span class='kw'>&lt;-</span> <span class='fu'>brm</span>(<span class='fu'><a href='brmsformula.html'>bf</a></span>(<span class='no'>y</span> ~ <span class='no'>x</span>, <span class='no'>sigma</span> ~ <span class='fl'>0</span> + <span class='no'>x</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>data_het</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit6</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>fit6</span>)
<span class='fu'><a href='conditional_effects.html'>conditional_effects</a></span>(<span class='no'>fit6</span>)

<span class='co'># extract estimated residual SDs of both groups</span>
<span class='no'>sigmas</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>exp</a></span>(<span class='fu'><a href='posterior_samples.html'>posterior_samples</a></span>(<span class='no'>fit6</span>, <span class='st'>"^b_sigma_"</span>))
<span class='fu'>ggplot</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/stack'>stack</a></span>(<span class='no'>sigmas</span>), <span class='fu'>aes</span>(<span class='no'>values</span>)) +
  <span class='fu'>geom_density</span>(<span class='fu'>aes</span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>ind</span>))


<span class='co'># Quantile regression predicting the 25%-quantile</span>
<span class='no'>fit7</span> <span class='kw'>&lt;-</span> <span class='fu'>brm</span>(<span class='fu'><a href='brmsformula.html'>bf</a></span>(<span class='no'>y</span> ~ <span class='no'>x</span>, <span class='kw'>quantile</span> <span class='kw'>=</span> <span class='fl'>0.25</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>data_het</span>,
            <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='brmsfamily.html'>asym_laplace</a></span>())
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit7</span>)
<span class='fu'><a href='conditional_effects.html'>conditional_effects</a></span>(<span class='no'>fit7</span>)


<span class='co'># use the future package for more flexible parallelization</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>future</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/future/topics/plan'>plan</a></span>(<span class='no'>multiprocess</span>)
<span class='no'>fit7</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/update'>update</a></span>(<span class='no'>fit7</span>, <span class='kw'>future</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Paul-Christian Buerkner <a href='mailto:paul.buerkner@gmail.com'>paul.buerkner@gmail.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

