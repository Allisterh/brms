<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Non-Linear Hypothesis Testing — hypothesis.brmsfit • brms</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Non-Linear Hypothesis Testing — hypothesis.brmsfit" />

<meta property="og:description" content="Perform non-linear hypothesis testing for all model parameters." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/brms_customfamilies.html">Define Custom Response Distributions with brms</a>
    </li>
    <li>
      <a href="../articles/brms_distreg.html">Estimating Distributional Models with brms</a>
    </li>
    <li>
      <a href="../articles/brms_families.html">Parameterization of Response Distributions in brms</a>
    </li>
    <li>
      <a href="../articles/brms_missings.html">Handle Missing Values with brms</a>
    </li>
    <li>
      <a href="../articles/brms_monotonic.html">Estimating Monotonic Effects with brms</a>
    </li>
    <li>
      <a href="../articles/brms_multivariate.html">Estimating Multivariate Models with brms</a>
    </li>
    <li>
      <a href="../articles/brms_nonlinear.html">Estimating Non-Linear Models with brms</a>
    </li>
    <li>
      <a href="../articles/brms_phylogenetics.html">Estimating Phylogenetic Multilevel Models with brms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paul-buerkner/brms">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Non-Linear Hypothesis Testing</h1>
    <small class="dont-index">Source: <a href='https://github.com/paul-buerkner/brms/blob/master/R/brmsfit-methods.R'><code>R/brmsfit-methods.R</code></a>, <a href='https://github.com/paul-buerkner/brms/blob/master/R/hypothesis.R'><code>R/hypothesis.R</code></a></small>
    <div class="hidden name"><code>hypothesis.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Perform non-linear hypothesis testing for all model parameters.</p>
    
    </div>

    <pre class="usage"><span class='co'># S3 method for brmsfit</span>
<span class='fu'>hypothesis</span>(<span class='no'>x</span>, <span class='no'>hypothesis</span>, <span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>"b"</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>scope</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"standard"</span>, <span class='st'>"ranef"</span>, <span class='st'>"coef"</span>), <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>hypothesis</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>hypothesis</span>(<span class='no'>x</span>, <span class='no'>hypothesis</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An <code>R</code> object. If it is no <code>brmsfit</code> object,
it must be coercible to a <code>data.frame</code>.</p></td>
    </tr>
    <tr>
      <th>hypothesis</th>
      <td><p>A character vector specifying one or more 
non-linear hypothesis concerning parameters of the model.</p></td>
    </tr>
    <tr>
      <th>class</th>
      <td><p>A string specifying the class of parameters being tested. 
Default is "b" for population-level effects. 
Other typical options are "sd" or "cor". 
If <code>class = NULL</code>, all parameters can be tested
against each other, but have to be specified with their full name 
(see also <code><a href='parnames.html'>parnames</a></code>)</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Name of a grouping factor to evaluate only 
group-level effects parameters related to this grouping factor.
Ignored if <code>class</code> is not <code>"sd"</code> or <code>"cor"</code>.</p></td>
    </tr>
    <tr>
      <th>scope</th>
      <td><p>Indicates where to look for the variables specified in
<code>hypothesis</code>. If <code>"standard"</code>, use the full parameter names
(subject to the restriction given by <code>class</code>). If <code>"coef"</code>
or <code>"ranef"</code> compute the hypothesis for all levels of 
the grouping factor given in <code>"group"</code>, based on the 
output of <code><a href='coef.brmsfit.html'>coef.brmsfit</a></code> and <code><a href='ranef.brmsfit.html'>ranef.brmsfit</a></code>,
respectively.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The alpha-level of the tests (default is 0.05;
see 'Details' for more information).</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>A single numeric value passed to <code>set.seed</code>
to make results reproducible.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='brmshypothesis.html'>brmshypothesis</a></code> object.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Among others, <code>hypothesis</code> computes an 
 evidence ratio (<code>Evid.Ratio</code>) for each hypothesis. 
 For a directed hypothesis, this is just the posterior probability 
 under the hypothesis against its alternative.
 That is, when the hypothesis if of the form <code>a &gt; b</code>, 
 the evidence ratio is the ratio of the posterior probability 
 of <code>a &gt; b</code> and the posterior probability of <code>a &lt; b</code>.
 In this example, values greater than one indicate that the evidence in
 favor of <code>a &gt; b</code> is larger than evidence in favor of <code>a &lt; b</code>.
 For an undirected (point) hypothesis, the evidence ratio 
 is a Bayes factor between the hypothesis and its alternative
 computed via the Savage-Dickey density ratio method.
 That is the posterior density at the point of interest divided
 by the prior density at that point.
 Values greater than one indicate that evidence in favor of the point
 hypothesis has increased after seeing the data.
 In order to calculate this Bayes factor, all parameters related 
 to the hypothesis must have proper priors
 and argument <code>sample_prior</code> of function <code>brm</code> 
 must be set to <code>TRUE</code>. 
 When interpreting Bayes factors, make sure 
 that your priors are reasonable and carefully chosen,
 as the result will depend heavily on the priors. 
 In particular, avoid using default priors.</p> 
<p>The argument <code>alpha</code> specifies the size of the credible interval
 (i.e., Bayesian confidence interval).
 For instance, if <code>alpha = 0.05</code> (5%), the credible interval
 will contain <code>1 - alpha = 0.95</code> (95%) of the posterior values.
 Hence, <code>alpha * 100</code>% of the posterior values will lie
 outside of the credible interval. Although this allows testing of
 hypotheses in a similar manner as in the frequentist null-hypothesis
 testing framework, we strongly argue against using arbitrary cutoffs 
 (e.g., <code>p &lt; .05</code>) to determine the 'existence' of an effect.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='brmshypothesis.html'>brmshypothesis</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>## define priors</span>
<span class='no'>prior</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'><a href='set_prior.html'>set_prior</a></span>(<span class='st'>"normal(0,2)"</span>, <span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>"b"</span>),
           <span class='fu'><a href='set_prior.html'>set_prior</a></span>(<span class='st'>"student_t(10,0,1)"</span>, <span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>"sigma"</span>),
           <span class='fu'><a href='set_prior.html'>set_prior</a></span>(<span class='st'>"student_t(10,0,1)"</span>, <span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>"sd"</span>))

<span class='co'>## fit a linear mixed effects models</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brm.html'>brm</a></span>(<span class='no'>time</span> ~ <span class='no'>age</span> + <span class='no'>sex</span> + <span class='no'>disease</span> + (<span class='fl'>1</span> + <span class='no'>age</span><span class='kw'>|</span><span class='no'>patient</span>),
           <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>kidney</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'><a href='brmsfamily.html'>lognormal</a></span>(),
           <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>prior</span>, <span class='kw'>sample_prior</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>adapt_delta</span> <span class='kw'>=</span> <span class='fl'>0.95</span>))

<span class='co'>## perform two-sided hypothesis testing</span>
(<span class='no'>hyp1</span> <span class='kw'>&lt;-</span> <span class='fu'>hypothesis</span>(<span class='no'>fit</span>, <span class='st'>"sexfemale = age + diseasePKD"</span>))
<span class='fu'>plot</span>(<span class='no'>hyp1</span>)
<span class='fu'>hypothesis</span>(<span class='no'>fit</span>, <span class='st'>"exp(age) - 3 = 0"</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)

<span class='co'>## perform one-sided hypothesis testing</span>
<span class='fu'>hypothesis</span>(<span class='no'>fit</span>, <span class='st'>"diseasePKD + diseaseGN - 3 &lt; 0"</span>)

<span class='fu'>hypothesis</span>(<span class='no'>fit</span>, <span class='st'>"age &lt; Intercept"</span>,
           <span class='kw'>class</span> <span class='kw'>=</span> <span class='st'>"sd"</span>, <span class='kw'>group</span>  <span class='kw'>=</span> <span class='st'>"patient"</span>)

<span class='co'>## test the amount of random intercept variance on all variance</span>
<span class='no'>h</span> <span class='kw'>&lt;-</span> <span class='fu'>paste</span>(<span class='st'>"sd_patient__Intercept^2 / (sd_patient__Intercept^2 +"</span>,
           <span class='st'>"sd_patient__age^2 + sigma^2) = 0"</span>)
(<span class='no'>hyp2</span> <span class='kw'>&lt;-</span> <span class='fu'>hypothesis</span>(<span class='no'>fit</span>, <span class='no'>h</span>, <span class='kw'>class</span> <span class='kw'>=</span> <span class='kw'>NULL</span>))
<span class='fu'>plot</span>(<span class='no'>hyp2</span>)

<span class='co'>## test more than one hypothesis at once</span>
<span class='no'>h</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"diseaseGN = diseaseAN"</span>, <span class='st'>"2 * diseaseGN - diseasePKD = 0"</span>)
(<span class='no'>hyp3</span> <span class='kw'>&lt;-</span> <span class='fu'>hypothesis</span>(<span class='no'>fit</span>, <span class='no'>h</span>))
<span class='fu'>plot</span>(<span class='no'>hyp3</span>, <span class='kw'>ignore_prior</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## compute hypotheses for all levels of a grouping factor</span>
<span class='fu'>hypothesis</span>(<span class='no'>fit</span>, <span class='st'>"age = 0"</span>, <span class='kw'>scope</span> <span class='kw'>=</span> <span class='st'>"coef"</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='st'>"patient"</span>)

<span class='co'>## use the default method</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>as.data.frame</span>(<span class='no'>fit</span>)
<span class='fu'>hypothesis</span>(<span class='no'>dat</span>, <span class='st'>"b_age &gt; 0"</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Paul-Christian Buerkner <a href='mailto:paul.buerkner@gmail.com'>paul.buerkner@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

